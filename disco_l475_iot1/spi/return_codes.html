

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Return Codes &mdash; Zephyr Driver Documentation 0.0.1 documentation</title>
  

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/css/blue_highlight.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Slave mode" href="slave_mode.html" />
    <link rel="prev" title="KConfig" href="kconfig.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home"> Zephyr Driver Documentation
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../issues.html">Issue Reporting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../particle_argon/index.html">Particle Argon</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Disco L475 IOT1</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="index.html">SPI</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="configuration.html">Configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="frequency_selection.html">Frequency Selection</a></li>
<li class="toctree-l3"><a class="reference internal" href="kconfig.html">KConfig</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Return Codes</a><ul class="simple">
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="slave_mode.html">Slave mode</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../change_main_clock.html">Change Main Clock</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../general/index.html">General</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Zephyr Driver Documentation</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../index.html">Disco L475 IOT1</a> &raquo;</li>
        
          <li><a href="index.html">SPI</a> &raquo;</li>
        
      <li>Return Codes</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="return-codes">
<h1>Return Codes<a class="headerlink" href="#return-codes" title="Permalink to this headline">¶</a></h1>
<div class="toctree-wrapper compound">
</div>
<p>This part will discuss what the possible return codes actually mean (thanks for the lack of documentation ZEPHYR)</p>
<ul>
<li><dl>
<dt>-EIO (-5)</dt><dd><p>This is just a general error code that the zephyr driver returns when anything wrong occurs with the SPI peripheral.
To get the actual error code from the STM32 SPI peripheral you will need to enable logging <code class="docutils literal notranslate"><span class="pre">CONFIG_LOG=y</span></code> in your <code class="docutils literal notranslate"><span class="pre">prj.conf</span></code> file,
this is since instead of returning the actual result zephyr feels the need to hide it, and log it instead.</p>
<a class="reference internal image-reference" href="../../_images/get_err.png"><img alt="../../_images/get_err.png" src="../../_images/get_err.png" style="width: 50%;" /></a>
<p>This code snippet is found in <code class="docutils literal notranslate"><span class="pre">zephyr/drivers/spi/spi_ll_stm32.c</span></code>. Once you get this value from the LOG output you will be able to
compare it to the <code class="docutils literal notranslate"><span class="pre">SR</span></code> register definition for your STM32 device. For the STM32L475VG the <code class="docutils literal notranslate"><span class="pre">SR</span></code> registers contents are as follows</p>
<a class="reference internal image-reference" href="../../_images/sr_reg.png"><img alt="../../_images/sr_reg.png" src="../../_images/sr_reg.png" style="width: 100%;" /></a>
<p>At the time of writing <code class="docutils literal notranslate"><span class="pre">SPI_STM32_ERR_MSK</span></code> for the STM32L475VG causes only <code class="docutils literal notranslate"><span class="pre">FRE</span></code>, <code class="docutils literal notranslate"><span class="pre">OVR</span></code>, <code class="docutils literal notranslate"><span class="pre">MODF</span></code> and <code class="docutils literal notranslate"><span class="pre">CRCERR</span></code> to be parsed,
the translation between error code and cause can be seen in the following table, if a value is not in this table try combinations (bitwise-OR),
if it is still not present then I don’t know what to tell you, I ain’t omnipitant.</p>
<table class="docutils align-default" id="id1">
<caption><span class="caption-text">STM32L475VG error codes</span><a class="headerlink" href="#id1" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Errorcode</p></th>
<th class="head"><p>Cause</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0x0010 (16)</p></td>
<td><p>CRC error</p></td>
</tr>
<tr class="row-odd"><td><p>0x0020 (32)</p></td>
<td><p>Mode fault (see page 1471 of reference manual)</p></td>
</tr>
<tr class="row-even"><td><p>0x0040 (64)</p></td>
<td><p>Overrun flag (i.e. you trying to send too much shit too fast)</p></td>
</tr>
<tr class="row-odd"><td><p>0x0100 (256)</p></td>
<td><p>Frame format error (used only in TI slave mode)</p></td>
</tr>
</tbody>
</table>
</dd>
</dl>
</li>
</ul>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="slave_mode.html" class="btn btn-neutral float-right" title="Slave mode" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="kconfig.html" class="btn btn-neutral float-left" title="KConfig" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2021, awkwardMathNerd.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>